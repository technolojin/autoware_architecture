<?xml version="1.0"?>
<launch>
  <!-- This launch file is auto-generated by the autoware_architect -->
  <!-- Component Launcher: {{ namespace }} -->
  <!-- Compute Unit: {{ compute_unit }} -->
  <!-- This launcher starts all nodes in component: {{ namespace }} -->

{% for node in nodes %}
  <!-- Node: {{ node.full_namespace }}/{{ node.name }} -->
{% if node.use_container %}
  <load_composable_node target="{{ node.container }}">
    <composable_node pkg="{{ node.package }}" plugin="{{ node.plugin }}" name="{{ node.name }}" namespace="{{ node.full_namespace }}">
      <!-- Remap input and output topics -->
{% for port in node.ports %}
      <remap from="~/{{ port.direction }}/{{ port.name }}" to="{{ port.topic }}"/>
{% endfor %}

      <!-- Parameters - Global (lowest priority, applied first) -->
{% for param in node.parameters %}
{% if param.parameter_type.name == 'GLOBAL' %}
      <param name="{{ param.name }}" value="{{ param.value }}"/>
{% endif %}
{% endfor %}

      <!-- Parameters - Default -->
{% for param in node.parameters %}
{% if param.parameter_type.name == 'DEFAULT' or param.parameter_type.name == 'DEFAULT_FILE' %}
      <param name="{{ param.name }}" value="{{ param.value }}"/>
{% endif %}
{% endfor %}

      <!-- Parameters - Parameter files -->
{% for param_file in node.parameter_files %}
      <param from="{{ param_file.path }}"/>
{% endfor %}

      <!-- Parameters - Overrides -->
{% for param in node.parameters %}
{% if param.parameter_type.name == 'OVERRIDE' %}
      <param name="{{ param.name }}" value="{{ param.value }}"/>
{% endif %}
{% endfor %}
    </composable_node>
  </load_composable_node>
{% else %}
  <node pkg="{{ node.package }}" exec="{{ node.executable }}" name="{{ node.name }}" namespace="{{ node.full_namespace }}" output="{{ node.node_output }}">
    <!-- Remap input and output topics -->
{% for port in node.ports %}
    <remap from="~/{{ port.direction }}/{{ port.name }}" to="{{ port.topic }}"/>
{% endfor %}

    <!-- Parameters - Global (lowest priority, applied first) -->
{% for param in node.parameters %}
{% if param.parameter_type.name == 'GLOBAL' %}
    <param name="{{ param.name }}" value="{{ param.value }}"/>
{% endif %}
{% endfor %}

    <!-- Parameters - Default -->
{% for param in node.parameters %}
{% if param.parameter_type.name == 'DEFAULT' or param.parameter_type.name == 'DEFAULT_FILE' %}
    <param name="{{ param.name }}" value="{{ param.value }}"/>
{% endif %}
{% endfor %}

    <!-- Parameters - Parameter files -->
{% for param_file in node.parameter_files %}
    <param from="{{ param_file.path }}"/>
{% endfor %}

    <!-- Parameters - Overrides -->
{% for param in node.parameters %}
{% if param.parameter_type.name == 'OVERRIDE' %}
    <param name="{{ param.name }}" value="{{ param.value }}"/>
{% endif %}
{% endfor %}
  </node>
{% endif %}

{% endfor %}
</launch>
