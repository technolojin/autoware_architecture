name: TrafficLightRecognitionMerge4.module

instances:
  - instance: occlusion_predictor1
    entity: TrafficLightOcclusionPredictor.node
  - instance: occlusion_predictor2
    entity: TrafficLightOcclusionPredictor.node
  - instance: occlusion_predictor3
    entity: TrafficLightOcclusionPredictor.node
  - instance: occlusion_predictor4
    entity: TrafficLightOcclusionPredictor.node

  - instance: multi_camera_fusion
    entity: TrafficLightMultiCameraFusion4.node
  - instance: traffic_light_arbiter
    entity: TrafficLightArbiter.node
  - instance: traffic_light_crosswalk_estimator
    entity: CrosswalkTrafficLightEstimator.node

external_interfaces:
  input:
    - name: vector_map
    - name: route
    - name: camera1/camera_info
    - name: camera1_traffic_signals_car
    - name: camera1_traffic_signals_pedestrian
    - name: camera1_rois
    - name: camera2/camera_info
    - name: camera2_traffic_signals_car
    - name: camera2_traffic_signals_pedestrian
    - name: camera2_rois
    - name: camera3/camera_info
    - name: camera3_traffic_signals_car
    - name: camera3_traffic_signals_pedestrian
    - name: camera3_rois
    - name: camera4/camera_info
    - name: camera4_traffic_signals_car
    - name: camera4_traffic_signals_pedestrian
    - name: camera4_rois
    - name: pointcloud
    - name: external_traffic_signals
  output:
    - name: traffic_signals

connections:
  - from: input.pointcloud
    to: occlusion_predictor1.input.cloud
  - from: input.vector_map
    to: occlusion_predictor1.input.vector_map
  - from: input.camera1/camera_info
    to: occlusion_predictor1.input.camera_info
  - from: input.camera1_rois
    to: occlusion_predictor1.input.rois
  - from: input.camera1_traffic_signals_car
    to: occlusion_predictor1.input.car/traffic_signals
  - from: input.camera1_traffic_signals_pedestrian
    to: occlusion_predictor1.input.pedestrian/traffic_signals

  - from: input.pointcloud
    to: occlusion_predictor2.input.cloud
  - from: input.vector_map
    to: occlusion_predictor2.input.vector_map
  - from: input.camera2/camera_info
    to: occlusion_predictor2.input.camera_info
  - from: input.camera2_rois
    to: occlusion_predictor2.input.rois
  - from: input.camera2_traffic_signals_car
    to: occlusion_predictor2.input.car/traffic_signals
  - from: input.camera2_traffic_signals_pedestrian
    to: occlusion_predictor2.input.pedestrian/traffic_signals

  - from: input.pointcloud
    to: occlusion_predictor3.input.cloud
  - from: input.vector_map
    to: occlusion_predictor3.input.vector_map
  - from: input.camera3/camera_info
    to: occlusion_predictor3.input.camera_info
  - from: input.camera3_rois
    to: occlusion_predictor3.input.rois
  - from: input.camera3_traffic_signals_car
    to: occlusion_predictor3.input.car/traffic_signals
  - from: input.camera3_traffic_signals_pedestrian
    to: occlusion_predictor3.input.pedestrian/traffic_signals

  - from: input.pointcloud
    to: occlusion_predictor4.input.cloud
  - from: input.vector_map
    to: occlusion_predictor4.input.vector_map
  - from: input.camera4/camera_info
    to: occlusion_predictor4.input.camera_info
  - from: input.camera4_rois
    to: occlusion_predictor4.input.rois
  - from: input.camera4_traffic_signals_car
    to: occlusion_predictor4.input.car/traffic_signals
  - from: input.camera4_traffic_signals_pedestrian
    to: occlusion_predictor4.input.pedestrian/traffic_signals

  - from: input.vector_map
    to: multi_camera_fusion.input.vector_map
  - from: input.camera1/camera_info
    to: multi_camera_fusion.input.camera1/camera_info
  - from: occlusion_predictor1.output.traffic_signals
    to: multi_camera_fusion.input.camera1/classification/traffic_signals
  - from: input.camera1_rois
    to: multi_camera_fusion.input.camera1/detection/rois
  - from: input.camera2/camera_info
    to: multi_camera_fusion.input.camera2/camera_info
  - from: occlusion_predictor2.output.traffic_signals
    to: multi_camera_fusion.input.camera2/classification/traffic_signals
  - from: input.camera2_rois
    to: multi_camera_fusion.input.camera2/detection/rois
  - from: input.camera3/camera_info
    to: multi_camera_fusion.input.camera3/camera_info
  - from: occlusion_predictor3.output.traffic_signals
    to: multi_camera_fusion.input.camera3/classification/traffic_signals
  - from: input.camera3_rois
    to: multi_camera_fusion.input.camera3/detection/rois
  - from: input.camera4/camera_info
    to: multi_camera_fusion.input.camera4/camera_info
  - from: occlusion_predictor4.output.traffic_signals
    to: multi_camera_fusion.input.camera4/classification/traffic_signals
  - from: input.camera4_rois
    to: multi_camera_fusion.input.camera4/detection/rois

  - from: input.vector_map
    to: traffic_light_arbiter.input.vector_map
  - from: multi_camera_fusion.output.traffic_signals
    to: traffic_light_arbiter.input.perception_traffic_signals
  - from: input.external_traffic_signals
    to: traffic_light_arbiter.input.external_traffic_signals

  - from: input.vector_map
    to: traffic_light_crosswalk_estimator.input.vector_map
  - from: input.route
    to: traffic_light_crosswalk_estimator.input.route
  - from: traffic_light_arbiter.output.traffic_signals
    to: traffic_light_crosswalk_estimator.input.traffic_signals
  - from: traffic_light_crosswalk_estimator.output.traffic_signals
    to: output.traffic_signals